{"version":3,"sources":["meteor://ðŸ’»app/lib/controllers/route_controller.js"],"names":[],"mappings":"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","file":"/lib/controllers/route_controller.js","sourcesContent":["\n  /*******************************************************************\\\n  |  Controller to suscribe on data assiocate with the current route  |\n  \\*******************************************************************/\n\nHomeController = RouteController.extend({\n  subscriptions: function() {\n  },\n  waitOn: function () {\n  },\n  data: function () {\n  },\n  \n  onRun: function () {\n    this.next();\n  },\n  onRerun: function () {\n    this.next();\n  },\n  onBeforeAction: function () {\n    this.next();\n  },\n  action: function () {\n    this.render();\n  },\n  onAfterAction: function () {\n  },\n  onStop: function () {\n  }\n});\n\n\n/*******************\n * PROFILER SYSTEM *\n *******************/\n \n/*  \n *  Retrieve informations in local/session storage if previous exit/encoding url \n *  Redirection to last route if not a valid url or not visited yet,\n *  return false if no need redirection \n */\nfunction redirect (sessionAndLocal) {\n\tvar lastPicture = parseInt(sessionStorage.getItem(\"lastPicture\"));\n\tvar lastModule = sessionStorage.getItem(\"lastModule\");\n    //if there is something in session\n    if(lastModule && sessionAndLocal) {\n            var paramImg = parseInt(Router.current().params.img);\n            var moduleEncoded = getCurrentModule(Router.current().route.getName());\n            //if not a valid url\n            if(moduleEncoded.title != \"Form\" && (isNaN(paramImg) || paramImg <= 0)){\n                //redirect to last position\n                Router.go(lastModule, {img: lastPicture});\n            } else {\n                Meteor.call('isAdmin', function (error, result) { \n                    if(result) {\n                        return false;\n                    } else { //if it's not an admin\n                        var module = getCurrentModule(lastModule);\n                        //pattern of accepted path\n                        if( (module.title == \"Index\" && moduleEncoded.title == \"Valid\" && paramImg == 1) ||\n                            (paramImg < parseInt(lastPicture)) || \n                            ((paramImg == parseInt(lastPicture) && moduleEncoded.order <= module.order + 1)) || \n                            ((paramImg == parseInt(lastPicture) + 1) && (moduleEncoded.title == \"Valid\" || moduleEncoded.title == \"Upload\") && (module.title == \"Valid\" || module.title == \"Select\" || module.title == \"Choose\")) ||\n                            (isSatis() && ((moduleEncoded.title == \"Valid\") || (moduleEncoded.title == \"Upload\") || (moduleEncoded.title == \"Form\"))) ||\n                            (moduleEncoded.title == \"Form\" && (module.title == \"Upload\" || module.title == \"Valid\" || module.title == \"Select\" || module.title == \"Choose\")) ) {\n                            \n                            return false;\n                        } else {\n                            //redirect to last position only if user want a page not visited yet or not accepted\n                            Router.go(lastModule, {img: lastPicture});\n                        }\n                    }\n                });\n            }\n    } else {\n        //only in local\n        if(!lastModule)Â {\n            //else retrieve everything from localStorage\n            var currentSurvey = JSON.parse(localStorage.getItem(\"currentSurvey\"));\n            var correction_profiles = JSON.parse(localStorage.getItem(\"correction_profiles\"));\n            var correction_profile_result = JSON.parse(localStorage.getItem(\"correction_profile_result\"));\n            lastModule = localStorage.getItem(\"lastModule\");\n            lastPicture = parseInt(localStorage.getItem(\"lastPicture\"));\n            \n            //no local and no session storage\n            if(!lastModule) {\n                //redirect to index\n                Router.go(\"Index\");\n            } else {\n                //set in session\n                sessionStorage.setItem(\"currentSurvey\", JSON.stringify(currentSurvey));\n                sessionStorage.setItem(\"correction_profiles\", JSON.stringify(correction_profiles));\n                sessionStorage.setItem(\"correction_profile_result\", JSON.stringify(correction_profile_result));\n                sessionStorage.setItem(\"lastModule\", lastModule);\n                sessionStorage.setItem(\"lastPicture\", lastPicture);\n                \n                //remove data in local\n                localStorage.clear();\n                \n                //redirect to last position\n                Router.go(lastModule, {img: lastPicture});\n            }\n            \n        } else {\n            return false;\n        }\n    }\n}\n\nIndexController = HomeController.extend({\n    /* redirection if need, or go on if no problem */\n    onBeforeAction: function() {\n        if(!redirect(false)) this.next();\n    },\n    data: function() {\n        var data = IndexController.__super__.data.call(this);\n        return data;\n    },\n    waitOn : function() { \n        var currentUser = Meteor.user();\n        return [\n            Meteor.subscribe('survey', currentUser),\n            Meteor.subscribe('module_survey'),\n            Meteor.subscribe('picture_admin'),\n            Meteor.subscribe('instruction'),\n            Meteor.subscribe('info_txt'),\n            Meteor.subscribe('sorted_color_admin'),\n            Meteor.subscribe('filter_admin'),\n            Meteor.subscribe('field_form')\n        ];\n    }\n});\n\n/* every modules with pictures */\nPictureController = HomeController.extend({\n    onBeforeAction: function() {\n        if(!redirect(true)) this.next();\n    },\n    data: function() {\n        var data = PictureController.__super__.data.call(this);\n        return data;\n    },\n    waitOn : function() {\n        return [\n            Meteor.subscribe('picture_upload')\n        ];\n    }\n});\n\nFormController =  HomeController.extend({\n    onBeforeAction: function() {\n        if(!redirect(true)) this.next();\n    },\n    data: function() {\n        var data = PictureController.__super__.data.call(this);\n        return data;\n    },\n    waitOn : function() {\n        var currentUser = Meteor.user();\n        return [\n            Meteor.subscribe('survey'),\n      \t\tMeteor.subscribe('user', currentUser, false, true)\n        ];\n    }\n});\n\n\nThanksController = HomeController.extend({\n    waitOn: function() {\n        var currentUser = Meteor.user();\n        var userId = this.params.idUser;\n        return [\n            Meteor.subscribe('survey', currentUser),\n            Meteor.subscribe('module_survey'),\n            Meteor.subscribe('picture_admin'),\n            Meteor.subscribe('instruction'),\n            Meteor.subscribe('info_txt'),\n            Meteor.subscribe('sorted_color_admin'),\n            Meteor.subscribe('filter_admin'),\n            Meteor.subscribe('field_form'),\n            \n      \t\tMeteor.subscribe('user', currentUser, userId),\n      \t\tMeteor.subscribe('correction_profile_picture'),\n            Meteor.subscribe('correction_profile_result'),\n      \t\tMeteor.subscribe('filter'),\n            Meteor.subscribe('picture'),\n            Meteor.subscribe('target')\n        ];\n    }\n});\n\n/***************\n * Admin panel *\n ***************/\n\nLoginAdminController = HomeController.extend({\n    onBeforeAction : function() {\n        var currentUser = Meteor.user();\n        if(currentUser && currentUser.username === \"admin\"){\n            Router.go(\"Dashboard\");\n        } else {\n            this.next();\n        }   \n    },\n    waitOn : function() {\n        return Meteor.subscribe(\"admin\");\n    }\n});\n\nAdminController = HomeController.extend({\n    onBeforeAction : function() {\n        var currentUser = Meteor.user();\n        if(currentUser && currentUser.username === \"admin\"){\n            this.next();\n        } else {\n            Router.go(\"Login\");\n        }\n    },\n    waitOn : function() {\n        var currentUser = Meteor.user();\n        return [\n            Meteor.subscribe('survey', currentUser),\n            Meteor.subscribe('module_survey'),\n            Meteor.subscribe('picture_admin'),\n            Meteor.subscribe('instruction'),\n            Meteor.subscribe('info_txt'),\n            Meteor.subscribe('sorted_color_admin'),\n            Meteor.subscribe('filter_admin'),\n            Meteor.subscribe('field_form')\n        ];\n    }\n});\n\n/* every modules in admin panel with pictures */\nPictureAdminController = AdminController.extend({\n    data: function() {\n        var data = PictureAdminController.__super__.data.call(this);\n        return data;\n    },\n    waitOn : function() {\n        var waitOn = AdminMockController.__super__.waitOn.call(this);\n        return [\n            waitOn,\n            Meteor.subscribe('picture_upload')\n        ];\n    }\n});\n\nAdminMockController = AdminController.extend({\n    onBeforeAction: function() {\n        var onBeforeAction = AdminMockController.__super__.onBeforeAction.call(this);\n        return onBeforeAction;\n    },\n    waitOn: function() {\n        var waitOn = AdminMockController.__super__.waitOn.call(this);\n        return waitOn;\n    }\n});\n\nDashboardController = AdminController.extend({\n    onBeforeAction: function() {\n        var onBeforeAction = DashboardController.__super__.onBeforeAction.call(this);\n        return onBeforeAction;\n    },\n    waitOn: function() {\n        var currentUser = Meteor.user();\n        var waitOn = DashboardController.__super__.waitOn.call(this);\n        return [\n            waitOn,\n      \t\tMeteor.subscribe('user', currentUser),\n      \t\tMeteor.subscribe('correction_profile_picture'),\n            Meteor.subscribe('correction_profile_result'),\n      \t\tMeteor.subscribe('filter'),\n            Meteor.subscribe('picture'),\n            Meteor.subscribe('target')\n        ];\n        \n    }\n});\n\nProfileController = AdminController.extend({\n    onBeforeAction: function() {\n        var onBeforeAction = ProfileController.__super__.onBeforeAction.call(this);\n        return onBeforeAction;\n    },\n    waitOn: function() {\n        var currentUser = Meteor.user();\n        var userId = this.params.idUser;\n        var waitOn = ProfileController.__super__.waitOn.call(this);\n        return [\n            waitOn,\n      \t\tMeteor.subscribe('user', currentUser, userId),\n      \t\tMeteor.subscribe('correction_profile_picture'),\n            Meteor.subscribe('correction_profile_result'),\n      \t\tMeteor.subscribe('filter'),\n            Meteor.subscribe('picture'),\n            Meteor.subscribe('target')\n        ];\n    }\n});"]}