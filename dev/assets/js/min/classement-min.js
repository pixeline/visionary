$(document).ready(function(){var e={},t=[],a=[],o=$("#list-normal"),n=$(".btn-print"),i="",r={},s=!0,l=!1,d,c,u={succeed:"Aucun",protan:"Protane (Rouge - bleu vert)",deutan:"Deutan (Vert - rouge pourpre)",tritan:"Tritane (Violet - jaune vert)"},m=function(a){$.getJSON("/assets/js/data/data.json",function(o){e=o,t=shuffleArray(e.colors),g(),$("#choices .pick").shuffle(),$("#choices .pick").each(function(e,t){$(this).find("a").text(e+1)}),$("html").addClass("js-testDeClassement"),$(window).trigger("resize"),a&&a()})},p=function(){console.log("updateOrder"),a=[],o.find("li").each(function(){void 0!==$(this).data("item")&&a.push(parseInt($(this).data("item")))}),$("#diag_serie").val(a.join(",")),t=orderArray(e.colors,a),s?l||($("#list-normal").addClass("sortable").sortable({disabled:!1,cancel:".ignore",unmove:".ignore",constraint:"x",updateHandler:function(e,t){return!0}}).on("sortable:start",function(e,t){t.item.addClass("dragging")}).on("sortable:stop",function(e,t){t.item.removeClass("dragging"),p()}),$(".color-item").first().addClass("pilot ignore"),l=!0):($("#list-normal").removeClass("sortable").sortable({disabled:!0}),$(".color-item").first().removeClass("pilot ignore")),$(window).trigger("resize"),r=new MomentOfInertia(t),f()},g=function(){for(console.log("drawDom"),o.empty(),d=0;d<t.length;d++)i=$("<li></li>").data("item",t[d].id).addClass("color-item").css("background-color",t[d].color),o.append(i);o.find("li").velocity("transition.slideDownIn",{duration:400,stagger:20}),p()},f=function(){console.log("checkResult");var e="fail";r.c_index<=1.6?($(".cvd_type").html("n'êtes pas daltonien"),e="succeed"):r.majorAngle>=.7?($(".cvd_type").html("êtes daltonien de type protanope"),e="protan"):r.majorAngle<-65?($(".cvd_type").html("êtes daltonien de type tritanope"),e="tritan"):($(".cvd_type").html("êtes daltonien de type deuteranope"),e="deutan");var t=r.c_index;1.6>t&&(t=1.6),t>4.2&&(t=4.2),r.serie=a,r.result=e,r.ratio=Math.round(100*(t-1.6)/2.6)+"%";for(var o in r){var n,i=parseFloat(r[o]);switch(o){case"angle":n=i.toFixed(1);break;case"c_index":n=i.toFixed(2);break;case"majorAngle":n=i.toFixed(1);break;case"majorRadius":n=i.toFixed(1);break;case"minorRadius":n=i.toFixed(1);break;case"s_index":n=i.toFixed(2);break;case"tes":n=i.toFixed(1);break;case"serie":n=r[o].join(",");break;case"result":n=r[o];break;case"ratio":n=r[o]}$("#"+o).val(n)}};$("#test").length&&m(function(){$("#test").removeClass("hide").velocity("transition.slideUpIn",{duration:420})})});